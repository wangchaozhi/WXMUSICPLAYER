# wxWidgets 音乐播放器 - 完整安装指南

## 问题诊断

您的系统缺少 wxWidgets 库，这是导致 DLL 找不到错误的根本原因。

## 解决方案

### 方案 1：使用 vcpkg 安装 wxWidgets（推荐）

#### 步骤 1：安装 vcpkg

1. 打开 PowerShell 或命令提示符
2. 运行以下命令：

```powershell
# 克隆vcpkg仓库
git clone https://github.com/Microsoft/vcpkg.git
cd vcpkg

# 运行bootstrap脚本
.\bootstrap-vcpkg.bat

# 将vcpkg添加到系统PATH（可选）
.\vcpkg integrate install
```

#### 步骤 2：安装 wxWidgets

```powershell
# 安装wxWidgets
.\vcpkg install wxwidgets:x64-windows

# 验证安装
.\vcpkg list | findstr wxwidgets
```

#### 步骤 3：重新构建项目

```powershell
# 回到项目目录
cd E:\RustroverProjects\wxmusicplayer

# 清理旧的构建文件
if (Test-Path "build") { Remove-Item -Recurse -Force "build" }

# 重新构建
.\build_simple.bat
```

### 方案 2：手动下载安装 wxWidgets

#### 步骤 1：下载 wxWidgets

1. 访问 https://www.wxwidgets.org/downloads/
2. 下载 Windows 版本的 wxWidgets（推荐 3.1.0 或 3.2.0）
3. 解压到 `C:\wxWidgets-3.1.0\`

#### 步骤 2：编译 wxWidgets

1. 打开命令提示符
2. 运行以下命令：

```cmd
cd C:\wxWidgets-3.1.0\build\msw
nmake -f makefile.vc BUILD=release SHARED=0 TARGET_CPU=X64
```

#### 步骤 3：设置环境变量

```cmd
set WXWIN=C:\wxWidgets-3.1.0
set PATH=%WXWIN%\lib\vc14x_dll;%PATH%
```

### 方案 3：使用预编译的 wxWidgets

如果您不想自己编译，可以使用预编译的版本：

1. 访问 https://github.com/wxWidgets/wxWidgets/releases
2. 下载预编译的 Windows 版本
3. 解压并设置环境变量

## 验证安装

安装完成后，运行以下命令验证：

```powershell
# 检查CMake是否能找到wxWidgets
cmake --find-package -DNAME=wxWidgets -DCOMPILER_ID=GNU

# 或者检查vcpkg安装
vcpkg list | findstr wxwidgets
```

## 常见问题解决

### 问题 1：CMake 找不到 wxWidgets

**解决方案：**

```powershell
# 设置CMAKE_PREFIX_PATH
$env:CMAKE_PREFIX_PATH = "C:\vcpkg\installed\x64-windows"

# 或者设置wxWidgets_DIR
$env:wxWidgets_DIR = "C:\vcpkg\installed\x64-windows\share\wxwidgets"
```

### 问题 2：编译时链接错误

**解决方案：**

1. 确保 wxWidgets 版本与编译器版本匹配
2. 检查 CMakeLists.txt 中的链接设置
3. 尝试使用静态链接版本

### 问题 3：运行时 DLL 错误

**解决方案：**

1. 确保 DLL 文件在 PATH 中
2. 或者使用静态链接版本
3. 将 DLL 文件复制到程序目录

## 推荐的完整流程

1. **安装 vcpkg**（如果还没有）
2. **安装 wxWidgets**：`vcpkg install wxwidgets:x64-windows`
3. **设置环境变量**：
   ```powershell
   $env:CMAKE_PREFIX_PATH = "C:\vcpkg\installed\x64-windows"
   ```
4. **重新构建项目**：`.\build_simple.bat`
5. **运行程序**：`.\build\bin\Release\wxmusicplayer.exe`

## 文件说明

- `build_simple.bat` - 标准构建脚本
- `build_static.bat` - 静态链接构建脚本
- `fix_dll_issues.bat` - DLL 问题修复脚本
- `DLL_问题解决指南.md` - 详细的 DLL 问题解决指南

## 技术支持

如果仍然遇到问题，请：

1. 检查错误信息的具体内容
2. 确认 wxWidgets 版本和编译器版本匹配
3. 查看 CMake 配置输出信息
4. 尝试使用静态链接版本
